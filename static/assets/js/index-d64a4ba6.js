import{N as e,k as a,r as t,w as n,f as l,a4 as i,a6 as r,c as d,a2 as o,a8 as u,u as s,L as v,a3 as p,i as m,F as _,J as c}from"./@vue-11129043.js";import{p as g}from"./p-center-modal-b39d0887.js";import"./dayjs-04e8f6f9.js";import{S as f,T as h,U as b,x as j,V as y}from"./index-e150f431.js";import{n as x,s as I,d as E}from"./common-3c8652c5.js";import{m as w,F as k,E as U}from"./ant-design-vue-05054bf0.js";import{c as C}from"./count-animation-3b6c0654.js";import{_ as q}from"./page-container-fd59b876.js";import"./pinia-1ca0c29b.js";import"./vue-demi-a81ff0a7.js";import"./store-bc016a64.js";import"./_plugin-vue_export-helper-9b9a8a5b.js";import"./@babel-eab0ef53.js";import"./axios-93d3568f.js";import"./qs-8fb0a9f1.js";import"./side-channel-ee547e73.js";import"./get-intrinsic-53528089.js";import"./has-symbols-1f359e75.js";import"./function-bind-c930bb92.js";import"./has-03e8e28c.js";import"./call-bind-566c57e8.js";import"./object-inspect-5c6480f3.js";import"./vue-router-36397834.js";import"./vue3-colorpicker-e1559e09.js";import"./vue-types-0fd36d85.js";import"./is-plain-object-39134198.js";import"./tinycolor2-e232e212.js";import"./@vueuse-94329f85.js";import"./@aesoper-316802a3.js";import"./vue3-angle-2884cf46.js";import"./gradient-parser-c9367eab.js";import"./lodash-es-0ceb8576.js";import"./@popperjs-31624eb1.js";import"./resize-observer-polyfill-9cd09a67.js";import"./@ant-design-477981d5.js";import"./@ctrl-16df70a4.js";import"./dom-align-6a5270eb.js";import"./async-validator-604317c1.js";import"./scroll-into-view-if-needed-8ce8502d.js";import"./compute-scroll-into-view-cce79123.js";import"./gsap-fedcb77b.js";const D=v("新建模式"),S=v("更新模式"),A=v("不计费"),N=v("VIP提交"),O=v("积分提交"),F=v("取消"),P=v("提交"),R={__name:"editOrAdd",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(v,{emit:m}){const _=v,{visible:c,dataObj:j}=e(_),y=()=>{m("update:visible",!1)},E=a({env_name:"",env_remarks:"",env_quantity:"",env_regex:"",env_mode:"1",env_update:"",env_is_plugin:!1,env_plugin_name:"",env_is_charging:"1",env_need_integral:""}),k={env_name:[{required:!0,trigger:"change"}],env_quantity:[{required:!0,trigger:"change"}],env_mode:[{required:!0,trigger:"change"}],env_is_plugin:[{required:!0,trigger:"change"}],env_is_charging:[{required:!0,trigger:"change"}]},U=t([]),C=(e,a)=>a.label.indexOf(e)>=0,q=e=>{},R=(...e)=>{},z={labelCol:{span:7},wrapperCol:{span:15}},V=e=>{E.env_is_plugin||(E.env_plugin_name="");const a={...E};let t=null;j.value.ID?(a.id=j.value.ID,t=h):t=b,a.env_mode=I(a.env_mode),a.env_is_charging=I(a.env_is_charging),a.env_need_integral=I(a.env_need_integral),t({data:a}).then((()=>{w.success("操作成功"),m("updateData",a),y()}))};n(c,((e,a,t)=>{c.value&&M()}));const M=()=>{f({splicingData:{type:"ordinary"}}).then((e=>{U.value=(e||[]).map((e=>(e.label=e.plugin_name,e.value=e.file_name,e)))})),j.value.ID?(E.env_name=j.value.EnvName,E.env_remarks=j.value.EnvRemarks,E.env_quantity=j.value.EnvQuantity,E.env_regex=j.value.EnvRegex,E.env_mode=x(j.value.EnvMode),E.env_update=j.value.EnvUpdate,E.env_is_plugin=j.value.EnvIsPlugin,E.env_plugin_name=j.value.EnvPluginName,E.env_is_charging=x(j.value.EnvIsCharging),E.env_need_integral=x(j.value.EnvNeedIntegral)):(E.env_name="",E.env_remarks="",E.env_quantity="",E.env_regex="",E.env_mode="1",E.env_update="",E.env_is_plugin=!1,E.env_plugin_name="",E.env_is_charging="1",E.env_need_integral="")};return(e,a)=>{const t=p("a-input"),n=p("a-form-item"),v=p("a-input-number"),m=p("a-radio"),_=p("a-radio-group"),f=p("a-switch"),h=p("a-select"),b=p("a-divider"),x=p("a-button"),I=p("a-form");return l(),i(g,{modalVisible:s(c),isFooter:!1,onClose:y,title:s(j).title},{content:r((()=>[d(I,u({ref:"formRef",name:"custom-validation",model:E,rules:k},z,{onValidate:R,onFinishFailed:q,onFinish:V}),{default:r((()=>[d(n,{label:"变量名",name:"env_name"},{default:r((()=>[d(t,{value:E.env_name,"onUpdate:value":a[0]||(a[0]=e=>E.env_name=e),placeholder:"请输入变量名"},null,8,["value"])])),_:1}),d(n,{label:"环境变量名称备注",name:"env_remarks"},{default:r((()=>[d(t,{value:E.env_remarks,"onUpdate:value":a[1]||(a[1]=e=>E.env_remarks=e),placeholder:"请输入环境变量名称备注"},null,8,["value"])])),_:1}),d(n,{label:"环境变量数量上限",name:"env_quantity"},{default:r((()=>[d(v,{value:E.env_quantity,"onUpdate:value":a[2]||(a[2]=e=>E.env_quantity=e),placeholder:"请输入环境变量数量上限",style:{},min:"0"},null,8,["value"])])),_:1}),d(n,{label:"环境变量匹配正则",name:"env_regex"},{default:r((()=>[d(t,{value:E.env_regex,"onUpdate:value":a[3]||(a[3]=e=>E.env_regex=e),placeholder:"请输入环境变量匹配正则"},null,8,["value"])])),_:1}),d(n,{label:"环境变量模式",name:"env_mode"},{default:r((()=>[d(_,{value:E.env_mode,"onUpdate:value":a[4]||(a[4]=e=>E.env_mode=e)},{default:r((()=>[d(m,{value:"1",name:"type"},{default:r((()=>[D])),_:1}),d(m,{value:"2",name:"type"},{default:r((()=>[S])),_:1})])),_:1},8,["value"])])),_:1}),d(n,{label:"环境变量更新匹配正则",name:"env_update"},{default:r((()=>[d(t,{value:E.env_update,"onUpdate:value":a[5]||(a[5]=e=>E.env_update=e),placeholder:"请输入环境变量更新匹配正则"},null,8,["value"])])),_:1}),d(n,{label:"环境变量是否使用插件",name:"env_is_plugin"},{default:r((()=>[d(f,{checked:E.env_is_plugin,"onUpdate:checked":a[6]||(a[6]=e=>E.env_is_plugin=e),"checked-children":"是","un-checked-children":"否"},null,8,["checked"])])),_:1}),E.env_is_plugin?(l(),i(n,{key:0,label:"绑定的插件名称",name:"env_plugin_name"},{default:r((()=>[d(h,{value:E.env_plugin_name,"onUpdate:value":a[7]||(a[7]=e=>E.env_plugin_name=e),placeholder:"请选择","filter-option":C,"show-search":"","option-label-prop":"label",options:U.value},null,8,["value","options"])])),_:1})):o("",!0),d(n,{label:"环境变量是否计费",name:"env_is_charging"},{default:r((()=>[d(_,{value:E.env_is_charging,"onUpdate:value":a[8]||(a[8]=e=>E.env_is_charging=e)},{default:r((()=>[d(m,{value:"1",name:"type"},{default:r((()=>[A])),_:1}),d(m,{value:"2",name:"type"},{default:r((()=>[N])),_:1}),d(m,{value:"3",name:"type"},{default:r((()=>[O])),_:1})])),_:1},8,["value"])])),_:1}),d(n,{label:"环境变量积分提交需要多少积分",name:"env_need_integral"},{default:r((()=>[d(v,{value:E.env_need_integral,"onUpdate:value":a[9]||(a[9]=e=>E.env_need_integral=e),style:{},placeholder:"请输入环境变量积分提交需要多少积分",min:"0"},null,8,["value"])])),_:1}),d(b),d(n,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:r((()=>[d(x,{onClick:y},{default:r((()=>[F])),_:1}),d(x,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:r((()=>[P])),_:1})])),_:1})])),_:1},16,["model"])])),_:1},8,["modalVisible","title"])}}},z=v(" 新增 "),V=v("修改 "),M=v(" 是否确认删除？ "),T=v("删除 "),K={__name:"index",setup(e){const n=t({}),u=t(!1),s=k.useForm,v=t(0),g=t(1),f=t(10);U.PRESENTED_IMAGE_SIMPLE;const h=a({s:""}),b=t(!1);s(h);const x=[{title:"ID",dataIndex:"ID",fixed:"left",width:120},{title:"变量名",dataIndex:"EnvName",width:200},{title:"变量备注",dataIndex:"EnvRemarks",width:200},{title:"变量限额",dataIndex:"EnvQuantity",width:200},{title:"变量提交正则",dataIndex:"EnvRegex",width:200},{title:"变量模式",dataIndex:"EnvMode",width:200},{title:"变量更新匹配正则",dataIndex:"EnvUpdate",width:200},{title:"变量是否使用插件",dataIndex:"EnvIsPlugin",width:200},{title:"变量绑定的插件名称",dataIndex:"EnvPluginName",width:280},{title:"变量是否计费",dataIndex:"EnvIsCharging",width:280},{title:"变量提交积分扣额",dataIndex:"EnvNeedIntegral",width:280},{title:"变量提示内容",dataIndex:"EnvTips",width:280},{title:"创建时间",dataIndex:"CreatedAt",width:280},{title:"更新时间",dataIndex:"UpdatedAt",width:280},{title:"操作",dataIndex:"operation",customKey:"operation",fixed:"right",width:300}],I=t([]),D=e=>{u.value=!0,n.value=e?{...e,title:"变量编辑"}:{title:"变量新增"}},S=e=>{e&&(g.value=1);let a={page:g.value,quantity:f.value};j({data:h,splicingData:a}).then((e=>{b.value?v.value=0:v.value=e.page*f.value,I.value=(e.pageData||e||[]).map((e=>(e.CreatedAt&&(e.CreatedAt=E(e.CreatedAt)),e.UpdatedAt&&(e.UpdatedAt=E(e.UpdatedAt)),e)))}))};return(e,a)=>{const t=p("a-button"),s=p("a-form-item"),b=p("a-form"),j=p("a-popconfirm");return l(),m(_,null,[d(R,{visible:u.value,"onUpdate:visible":a[0]||(a[0]=e=>u.value=e),onUpdateData:a[1]||(a[1]=e=>S(!0)),dataObj:n.value},null,8,["visible","dataObj"]),d(q,{columns:x,pageSize:f.value,"onUpdate:pageSize":a[3]||(a[3]=e=>f.value=e),current:g.value,"onUpdate:current":a[4]||(a[4]=e=>g.value=e),total:v.value,"onUpdate:total":a[5]||(a[5]=e=>v.value=e),isTable:!0,isSearch:!0,onOnShowSizeChange:S,onInitData:S,dataSource:I.value},{search:r((()=>[d(b,{class:"flex flex-warp",model:h},{default:r((()=>[d(s,null,{default:r((()=>[d(t,{type:"primary",onClick:a[2]||(a[2]=c((e=>D()),["prevent"])),class:"filter-search"},{default:r((()=>[z])),_:1})])),_:1})])),_:1},8,["model"])])),bodyCell:r((({text:e,record:a,index:n,column:u})=>["money"===u.customKey?(l(),i(C,{key:0,num:e},null,8,["num"])):o("",!0),"operation"===u.customKey?(l(),m(_,{key:1},[d(t,{type:"primary",onClick:c((e=>D(a)),["stop"]),style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:r((()=>[V])),_:2},1032,["onClick"]),d(j,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:e=>{y({data:{id:[a.ID]}}).then((()=>{w.success("操作成功!"),S(!0)}))}},{title:r((()=>[M])),default:r((()=>[d(t,{type:"danger",style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:r((()=>[T])),_:1})])),_:2},1032,["onConfirm"])],64)):o("",!0)])),_:1},8,["pageSize","current","total","dataSource"])],64)}}};export{K as default};
