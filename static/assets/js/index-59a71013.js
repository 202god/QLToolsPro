import{N as e,k as a,w as t,f as l,a4 as i,a6 as d,c as r,a8 as s,u as n,L as o,a3 as u,q as p,a2 as c,r as m,i as _,F as y,J as v}from"./@vue-11129043.js";import{p as f}from"./p-center-modal-b39d0887.js";import"./dayjs-04e8f6f9.js";import{W as k,X as b,Y as g,Z as h,_ as j,$ as x,a0 as C}from"./index-e150f431.js";import{m as w,F as I,E as U}from"./ant-design-vue-05054bf0.js";import{_ as K}from"./page-container-fd59b876.js";import{d as D}from"./common-3c8652c5.js";import{S,ak as F}from"./@ant-design-477981d5.js";import"./pinia-1ca0c29b.js";import"./vue-demi-a81ff0a7.js";import"./store-bc016a64.js";import"./_plugin-vue_export-helper-9b9a8a5b.js";import"./@babel-eab0ef53.js";import"./axios-93d3568f.js";import"./qs-8fb0a9f1.js";import"./side-channel-ee547e73.js";import"./get-intrinsic-53528089.js";import"./has-symbols-1f359e75.js";import"./function-bind-c930bb92.js";import"./has-03e8e28c.js";import"./call-bind-566c57e8.js";import"./object-inspect-5c6480f3.js";import"./vue-router-36397834.js";import"./vue3-colorpicker-e1559e09.js";import"./vue-types-0fd36d85.js";import"./is-plain-object-39134198.js";import"./tinycolor2-e232e212.js";import"./@vueuse-94329f85.js";import"./@aesoper-316802a3.js";import"./vue3-angle-2884cf46.js";import"./gradient-parser-c9367eab.js";import"./lodash-es-0ceb8576.js";import"./@popperjs-31624eb1.js";import"./resize-observer-polyfill-9cd09a67.js";import"./@ctrl-16df70a4.js";import"./dom-align-6a5270eb.js";import"./async-validator-604317c1.js";import"./scroll-into-view-if-needed-8ce8502d.js";import"./compute-scroll-into-view-cce79123.js";const q=o("取消"),A=o("提交"),O={__name:"editOrAdd",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(o,{emit:p}){const c=o,{visible:m,dataObj:_}=e(c),y=()=>{p("update:visible",!1)},v=a({state:!1,cd_key_remarks:""}),b={state:[{required:!0,trigger:"change"}],cd_key_remarks:[{required:!0,trigger:"change"}]},g=e=>{},h=(...e)=>{},j={labelCol:{span:7},wrapperCol:{span:15}},x=e=>{const a={...v};let t=null;_.value.ID&&(a.id=_.value.ID,t=k),t({data:a}).then((()=>{w.success("操作成功"),p("updateData",a),y()}))};t(m,((e,a,t)=>{m.value&&C()}));const C=()=>{_.value.ID?(v.state=_.value.CdKeyState,v.cd_key_remarks=_.value.CdKeyRemarks):(v.state=!1,v.cd_key_remarks="")};return(e,a)=>{const t=u("a-switch"),o=u("a-form-item"),p=u("a-input"),c=u("a-divider"),k=u("a-button"),C=u("a-form");return l(),i(f,{modalVisible:n(m),isFooter:!1,onClose:y,title:n(_).title},{content:d((()=>[r(C,s({ref:"formRef",name:"custom-validation",model:v,rules:b},j,{onValidate:h,onFinishFailed:g,onFinish:x}),{default:d((()=>[r(o,{label:"CD-KEY状态",name:"state"},{default:d((()=>[r(t,{checked:v.state,"onUpdate:checked":a[0]||(a[0]=e=>v.state=e),"checked-children":"开启","un-checked-children":"关闭"},null,8,["checked"])])),_:1}),r(o,{label:"CD-KEY标识",name:"cd_key_remarks"},{default:d((()=>[r(p,{value:v.cd_key_remarks,"onUpdate:value":a[1]||(a[1]=e=>v.cd_key_remarks=e)},null,8,["value"])])),_:1}),r(c),r(o,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:d((()=>[r(k,{onClick:y},{default:d((()=>[q])),_:1}),r(k,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:d((()=>[A])),_:1})])),_:1})])),_:1},16,["model"])])),_:1},8,["modalVisible","title"])}}},E=o("积分"),V=o("会员"),T=o("天卡"),z=o("周卡"),R=o("两周卡"),L=o("月卡"),P=o("季度"),Y=o("半年"),B=o("一年"),M=o("取消"),N=o("提交"),G={__name:"generateCardSecret",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(o,{emit:m}){const _=o,{visible:y,dataObj:v}=e(_),k=()=>{m("update:visible",!1)},h=a({cd_key_count:1,cd_key_type:"integral",cd_key_integral:void 0,cd_key_validity_period:"",cd_key_prefix:"",cd_key_remarks:""}),j=p((()=>({cd_key_integral:[{required:"integral"==h.cd_key_type,trigger:"change",message:"请输入卡密积分"}],cd_key_validity_period:[{required:"integral"!=h.cd_key_type,trigger:"change",message:"请选择卡密有效期"}],cd_key_count:[{required:!0,trigger:"change"}],cd_key_type:[{required:!0,trigger:"change"}]}))),x=()=>{"integral"==h.cd_key_type?(h.cd_key_validity_period=0,h.cd_key_integral=""):(h.cd_key_integral=0,h.cd_key_validity_period="")},C=e=>{},I=(...e)=>{},U={labelCol:{span:7},wrapperCol:{span:15}},K=e=>{const a={...h};b({data:a}).then((()=>{w.success("操作成功"),g(),m("updateData",a),k()}))};t(y,((e,a,t)=>{y.value&&D()}));const D=()=>{h.cd_key_count=1,h.cd_key_type="integral",h.cd_key_integral=void 0,h.cd_key_validity_period=0,h.cd_key_prefix="",h.cd_key_remarks=""};return(e,a)=>{const t=u("a-input-number"),o=u("a-form-item"),p=u("a-radio"),m=u("a-radio-group"),_=u("a-input"),v=u("a-divider"),b=u("a-button"),g=u("a-form");return l(),i(f,{modalVisible:n(y),isFooter:!1,onClose:k,title:"生成卡密"},{content:d((()=>[r(g,s({ref:"formRef",name:"custom-validation",model:h,rules:n(j)},U,{onValidate:I,onFinishFailed:C,onFinish:K}),{default:d((()=>[r(o,{label:"生成数量",name:"cd_key_count"},{default:d((()=>[r(t,{value:h.cd_key_count,"onUpdate:value":a[0]||(a[0]=e=>h.cd_key_count=e),style:{},min:"0"},null,8,["value"])])),_:1}),r(o,{label:"卡密类型",name:"cd_key_type"},{default:d((()=>[r(m,{value:h.cd_key_type,"onUpdate:value":a[1]||(a[1]=e=>h.cd_key_type=e),onChange:x},{default:d((()=>[r(p,{value:"integral",name:"type"},{default:d((()=>[E])),_:1}),r(p,{value:"vip",name:"type"},{default:d((()=>[V])),_:1})])),_:1},8,["value"])])),_:1}),"integral"==h.cd_key_type?(l(),i(o,{key:0,label:"卡密积分",name:"cd_key_integral"},{default:d((()=>[r(t,{value:h.cd_key_integral,"onUpdate:value":a[2]||(a[2]=e=>h.cd_key_integral=e),placeholder:"请输入卡密积分",style:{},min:"0"},null,8,["value"])])),_:1})):c("",!0),"vip"==h.cd_key_type?(l(),i(o,{key:1,label:"卡密有效期",name:"cd_key_validity_period"},{default:d((()=>[r(m,{value:h.cd_key_validity_period,"onUpdate:value":a[3]||(a[3]=e=>h.cd_key_validity_period=e)},{default:d((()=>[r(p,{value:1,name:"type"},{default:d((()=>[T])),_:1}),r(p,{value:7,name:"type"},{default:d((()=>[z])),_:1}),r(p,{value:14,name:"type"},{default:d((()=>[R])),_:1}),r(p,{value:31,name:"type"},{default:d((()=>[L])),_:1}),r(p,{value:92,name:"type"},{default:d((()=>[P])),_:1}),r(p,{value:183,name:"type"},{default:d((()=>[Y])),_:1}),r(p,{value:365,name:"type"},{default:d((()=>[B])),_:1})])),_:1},8,["value"])])),_:1})):c("",!0),r(o,{label:"卡密前缀",name:"cd_key_prefix"},{default:d((()=>[r(_,{value:h.cd_key_prefix,"onUpdate:value":a[4]||(a[4]=e=>h.cd_key_prefix=e)},null,8,["value"])])),_:1}),r(o,{label:"卡密标识",name:"cd_key_remarks"},{default:d((()=>[r(_,{value:h.cd_key_remarks,"onUpdate:value":a[5]||(a[5]=e=>h.cd_key_remarks=e)},null,8,["value"])])),_:1}),r(v),r(o,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:d((()=>[r(b,{onClick:k},{default:d((()=>[M])),_:1}),r(b,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:d((()=>[N])),_:1})])),_:1})])),_:1},16,["model","rules"])])),_:1},8,["modalVisible"])}}},J=o("生成卡密 "),W=o(" 搜索 "),X=o("重置 "),Z=o("启用"),$=o("禁用"),H=o("修改 "),Q=o(" 是否确认删除？ "),ee=o("删除 "),ae={__name:"index",setup(e){const t=m({}),s=m(!1),o=m(!1),f=m({}),k=I.useForm,b=m(0),g=m(1),q=m(10);U.PRESENTED_IMAGE_SIMPLE;const A=a({s:"",ctype:""});m(!1);const{resetFields:E,validate:V,validateInfos:T}=k(A),z=p((()=>({s:[{required:!1,trigger:"change",message:"请输入关键字"}]}))),R=m([{value:"",label:"全部"},{value:"integral",label:"积分"},{value:"vip",label:"会员"}]),L=[{title:"ID",dataIndex:"ID",fixed:"left",width:120},{title:"卡密显示",dataIndex:"CdKey",width:200},{title:"类型",dataIndex:"CdKeyTypeStr",width:200},{title:"积分",dataIndex:"CdKeyIntegral",width:200},{title:"有效期",dataIndex:"CdKeyValidityPeriod",width:200},{title:"标识",dataIndex:"CdKeyRemarks",width:200},{title:"状态",dataIndex:"CdKeyState",customKey:"state",width:200},{title:"创建时间",dataIndex:"CreatedAt",width:280},{title:"更新时间",dataIndex:"UpdatedAt",width:280},{title:"操作",dataIndex:"operation",customKey:"operation",fixed:"right",width:300}],P=m([]),Y=e=>{e&&(g.value=1);let a=null,t={page:g.value},l=!1;f.value.ctype?f.value.s?(a=j,t={s:f.value.s||"",ctype:f.value.ctype}):(l=!0,a=x,t={ctype:f.value.ctype,page:g.value,quantity:q.value}):(a=C,t={s:f.value.s||""}),a({data:A,splicingData:t}).then((e=>{b.value=l?e.page*q.value:0,P.value=(e.pageData||e||[]).map((e=>(e.CdKeyType&&(e.CdKeyTypeStr="vip"==e.CdKeyType?"会员":"积分"),e.CreatedAt&&(e.CreatedAt=D(e.CreatedAt)),e.UpdatedAt&&(e.UpdatedAt=D(e.UpdatedAt)),e)))}))},B=()=>{E(),f.value=A,Y(!0)},M=()=>{V().then((e=>{f.value=A,Y(!0)})).catch((e=>{}))};return(e,a)=>{const p=u("a-select"),m=u("a-form-item"),f=u("a-input"),k=u("a-button"),j=u("a-form"),x=u("count-animation"),C=u("a-popconfirm");return l(),_(y,null,[r(G,{visible:s.value,"onUpdate:visible":a[0]||(a[0]=e=>s.value=e),onUpdateData:a[1]||(a[1]=e=>Y(!0))},null,8,["visible"]),r(O,{visible:o.value,"onUpdate:visible":a[2]||(a[2]=e=>o.value=e),onUpdateData:a[3]||(a[3]=e=>Y(!0)),dataObj:t.value},null,8,["visible","dataObj"]),r(K,{columns:L,pageSize:q.value,"onUpdate:pageSize":a[7]||(a[7]=e=>q.value=e),current:g.value,"onUpdate:current":a[8]||(a[8]=e=>g.value=e),total:b.value,"onUpdate:total":a[9]||(a[9]=e=>b.value=e),isTable:!0,isSearch:!0,onOnShowSizeChange:Y,onInitData:Y,dataSource:P.value},{search:d((()=>[r(j,{class:"flex flex-warp",rules:n(z),onFinish:M,model:A},{default:d((()=>[r(m,{label:"类型:",name:"ctype"},{default:d((()=>[r(p,{value:A.ctype,"onUpdate:value":a[4]||(a[4]=e=>A.ctype=e),placeholder:"请选择",style:{width:"200px"},options:R.value},null,8,["value","options"])])),_:1}),r(m,{label:"关键字:",name:"s"},{default:d((()=>[r(f,{value:A.s,"onUpdate:value":a[5]||(a[5]=e=>A.s=e),placeholder:"请输入关键字"},null,8,["value"])])),_:1}),r(m,null,{default:d((()=>[r(k,{type:"primary",onClick:a[6]||(a[6]=v((e=>s.value=!0),["stop"])),shape:"round"},{default:d((()=>[J])),_:1}),r(k,{type:"primary","html-type":"submit",style:{"margin-left":"10px"},class:"filter-search"},{default:d((()=>[r(n(S)),W])),_:1}),r(k,{style:{"margin-left":"10px"},class:"filter-reset",onClick:B},{default:d((()=>[r(n(F)),X])),_:1})])),_:1})])),_:1},8,["rules","model"])])),bodyCell:d((({text:e,record:a,index:s,column:n})=>["state"===n.customKey?(l(),_(y,{key:0},[a.CdKeyState?(l(),i(k,{key:0,type:"link",primary:"",class:"state-button state-enable"},{default:d((()=>[Z])),_:1})):(l(),i(k,{key:1,type:"link",danger:"",class:"state-button"},{default:d((()=>[$])),_:1}))],64)):c("",!0),"money"===n.customKey?(l(),i(x,{key:1,num:e},null,8,["num"])):c("",!0),"operation"===n.customKey?(l(),_(y,{key:2},[r(k,{type:"primary",onClick:v((e=>{return l=a,o.value=!0,void(t.value=l?{...l,title:"卡密编辑"}:{title:"卡密新增"});var l}),["stop"]),style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:d((()=>[H])),_:2},1032,["onClick"]),r(C,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:e=>{h({data:{id_list:[a.ID]}}).then((()=>{w.success("操作成功!"),Y(!0)}))}},{title:d((()=>[Q])),default:d((()=>[r(k,{type:"danger",style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:d((()=>[ee])),_:1})])),_:2},1032,["onConfirm"])],64)):c("",!0)])),_:1},8,["pageSize","current","total","dataSource"])],64)}}};export{ae as default};
