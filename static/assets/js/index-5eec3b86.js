import{N as e,k as a,r as t,w as n,f as l,a4 as i,a6 as r,c as d,a2 as o,a8 as u,u as s,L as v,a3 as p,i as m,F as _,J as c}from"./@vue-11129043.js";import{p as g}from"./p-center-modal-916ba484.js";import"./dayjs-c306acb6.js";import{T as f,U as h,V as b,y as j,W as y,X as x}from"./index-9781d2dc.js";import{n as I,s as E,d as k}from"./common-3c8652c5.js";import{m as w,F as U,E as C}from"./ant-design-vue-93fc40b2.js";import{c as q}from"./count-animation-3b6c0654.js";import{_ as D}from"./page-container-94b32927.js";import"./pinia-1ca0c29b.js";import"./vue-demi-a81ff0a7.js";import"./store-325aa5d6.js";import"./_plugin-vue_export-helper-9b9a8a5b.js";import"./@babel-eab0ef53.js";import"./axios-93d3568f.js";import"./qs-8fb0a9f1.js";import"./side-channel-ee547e73.js";import"./get-intrinsic-53528089.js";import"./has-symbols-1f359e75.js";import"./function-bind-c930bb92.js";import"./has-03e8e28c.js";import"./call-bind-566c57e8.js";import"./object-inspect-5c6480f3.js";import"./vue-router-36397834.js";import"./vue3-colorpicker-e1559e09.js";import"./vue-types-0fd36d85.js";import"./is-plain-object-39134198.js";import"./tinycolor2-e232e212.js";import"./@vueuse-94329f85.js";import"./@aesoper-316802a3.js";import"./vue3-angle-2884cf46.js";import"./gradient-parser-c9367eab.js";import"./lodash-es-0ceb8576.js";import"./@popperjs-31624eb1.js";import"./resize-observer-polyfill-9cd09a67.js";import"./@ant-design-477981d5.js";import"./@ctrl-16df70a4.js";import"./dom-align-6a5270eb.js";import"./async-validator-604317c1.js";import"./scroll-into-view-if-needed-8ce8502d.js";import"./compute-scroll-into-view-cce79123.js";import"./gsap-fedcb77b.js";const S=v("新建模式"),A=v("更新模式"),N=v("不计费"),O=v("VIP提交"),F=v("积分提交"),P=v("取消"),R=v("提交"),z={__name:"editOrAdd",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(v,{emit:m}){const _=v,{visible:c,dataObj:j}=e(_),y=()=>{m("update:visible",!1)},x=a({env_name:"",env_remarks:"",env_quantity:"",env_regex:"",env_mode:"1",env_update:"",env_is_plugin:!1,env_plugin_name:"",env_is_charging:"1",env_need_integral:""}),k={env_name:[{required:!0,trigger:"change"}],env_quantity:[{required:!0,trigger:"change"}],env_mode:[{required:!0,trigger:"change"}],env_is_plugin:[{required:!0,trigger:"change"}],env_is_charging:[{required:!0,trigger:"change"}]},U=t([]),C=(e,a)=>a.label.indexOf(e)>=0,q=e=>{},D=(...e)=>{},z={labelCol:{span:7},wrapperCol:{span:15}},V=e=>{x.env_is_plugin||(x.env_plugin_name="");const a={...x};let t=null;j.value.ID?(a.id=j.value.ID,t=h):t=b,a.env_mode=E(a.env_mode),a.env_is_charging=E(a.env_is_charging),a.env_need_integral=E(a.env_need_integral),t({data:a}).then((()=>{w.success("操作成功"),m("updateData",a),y()}))};n(c,((e,a,t)=>{c.value&&L()}));const L=()=>{f({splicingData:{type:"ordinary"}}).then((e=>{U.value=(e||[]).map((e=>(e.label=e.plugin_name,e.value=e.file_name,e)))})),j.value.ID?(x.env_name=j.value.EnvName,x.env_remarks=j.value.EnvRemarks,x.env_quantity=j.value.EnvQuantity,x.env_regex=j.value.EnvRegex,x.env_mode=I(j.value.EnvMode),x.env_update=j.value.EnvUpdate,x.env_is_plugin=j.value.EnvIsPlugin,x.env_plugin_name=j.value.EnvPluginName,x.env_is_charging=I(j.value.EnvIsCharging),x.env_need_integral=I(j.value.EnvNeedIntegral)):(x.env_name="",x.env_remarks="",x.env_quantity="",x.env_regex="",x.env_mode="1",x.env_update="",x.env_is_plugin=!1,x.env_plugin_name="",x.env_is_charging="1",x.env_need_integral="")};return(e,a)=>{const t=p("a-input"),n=p("a-form-item"),v=p("a-input-number"),m=p("a-radio"),_=p("a-radio-group"),f=p("a-switch"),h=p("a-select"),b=p("a-divider"),I=p("a-button"),E=p("a-form");return l(),i(g,{modalVisible:s(c),isFooter:!1,onClose:y,title:s(j).title},{content:r((()=>[d(E,u({ref:"formRef",name:"custom-validation",model:x,rules:k},z,{onValidate:D,onFinishFailed:q,onFinish:V}),{default:r((()=>[d(n,{label:"变量名",name:"env_name"},{default:r((()=>[d(t,{value:x.env_name,"onUpdate:value":a[0]||(a[0]=e=>x.env_name=e),placeholder:"请输入变量名"},null,8,["value"])])),_:1}),d(n,{label:"环境变量名称备注",name:"env_remarks"},{default:r((()=>[d(t,{value:x.env_remarks,"onUpdate:value":a[1]||(a[1]=e=>x.env_remarks=e),placeholder:"请输入环境变量名称备注"},null,8,["value"])])),_:1}),d(n,{label:"环境变量数量上限",name:"env_quantity"},{default:r((()=>[d(v,{value:x.env_quantity,"onUpdate:value":a[2]||(a[2]=e=>x.env_quantity=e),placeholder:"请输入环境变量数量上限",style:{},min:"0"},null,8,["value"])])),_:1}),d(n,{label:"环境变量匹配正则",name:"env_regex"},{default:r((()=>[d(t,{value:x.env_regex,"onUpdate:value":a[3]||(a[3]=e=>x.env_regex=e),placeholder:"请输入环境变量匹配正则"},null,8,["value"])])),_:1}),d(n,{label:"环境变量模式",name:"env_mode"},{default:r((()=>[d(_,{value:x.env_mode,"onUpdate:value":a[4]||(a[4]=e=>x.env_mode=e)},{default:r((()=>[d(m,{value:"1",name:"type"},{default:r((()=>[S])),_:1}),d(m,{value:"2",name:"type"},{default:r((()=>[A])),_:1})])),_:1},8,["value"])])),_:1}),d(n,{label:"环境变量更新匹配正则",name:"env_update"},{default:r((()=>[d(t,{value:x.env_update,"onUpdate:value":a[5]||(a[5]=e=>x.env_update=e),placeholder:"请输入环境变量更新匹配正则"},null,8,["value"])])),_:1}),d(n,{label:"环境变量是否使用插件",name:"env_is_plugin"},{default:r((()=>[d(f,{checked:x.env_is_plugin,"onUpdate:checked":a[6]||(a[6]=e=>x.env_is_plugin=e),"checked-children":"是","un-checked-children":"否"},null,8,["checked"])])),_:1}),x.env_is_plugin?(l(),i(n,{key:0,label:"绑定的插件名称",name:"env_plugin_name"},{default:r((()=>[d(h,{value:x.env_plugin_name,"onUpdate:value":a[7]||(a[7]=e=>x.env_plugin_name=e),placeholder:"请选择","filter-option":C,"show-search":"","option-label-prop":"label",options:U.value},null,8,["value","options"])])),_:1})):o("",!0),d(n,{label:"环境变量是否计费",name:"env_is_charging"},{default:r((()=>[d(_,{value:x.env_is_charging,"onUpdate:value":a[8]||(a[8]=e=>x.env_is_charging=e)},{default:r((()=>[d(m,{value:"1",name:"type"},{default:r((()=>[N])),_:1}),d(m,{value:"2",name:"type"},{default:r((()=>[O])),_:1}),d(m,{value:"3",name:"type"},{default:r((()=>[F])),_:1})])),_:1},8,["value"])])),_:1}),d(n,{label:"环境变量积分提交需要多少积分",name:"env_need_integral"},{default:r((()=>[d(v,{value:x.env_need_integral,"onUpdate:value":a[9]||(a[9]=e=>x.env_need_integral=e),style:{},placeholder:"请输入环境变量积分提交需要多少积分",min:"0"},null,8,["value"])])),_:1}),d(b),d(n,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:r((()=>[d(I,{onClick:y},{default:r((()=>[P])),_:1}),d(I,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:r((()=>[R])),_:1})])),_:1})])),_:1},16,["model"])])),_:1},8,["modalVisible","title"])}}},V=v(" 新增 "),L=v(" 是否确认刷新缓存？ "),M=v("手动刷新缓存 "),T=v("修改 "),K=v(" 是否确认删除？ "),Q=v("删除 "),B={__name:"index",setup(e){const n=t({}),u=t(!1),s=U.useForm,v=t(0),g=t(1),f=t(10);C.PRESENTED_IMAGE_SIMPLE;const h=a({s:""}),b=t(!1);s(h);const I=[{title:"ID",dataIndex:"ID",fixed:"left",width:120},{title:"变量名",dataIndex:"EnvName",width:200},{title:"变量备注",dataIndex:"EnvRemarks",width:200},{title:"变量限额",dataIndex:"EnvQuantity",width:200},{title:"变量提交正则",dataIndex:"EnvRegex",width:200},{title:"变量模式",dataIndex:"EnvMode",width:200},{title:"变量更新匹配正则",dataIndex:"EnvUpdate",width:200},{title:"变量是否使用插件",dataIndex:"EnvIsPlugin",width:200},{title:"变量绑定的插件名称",dataIndex:"EnvPluginName",width:280},{title:"变量是否计费",dataIndex:"EnvIsCharging",width:280},{title:"变量提交积分扣额",dataIndex:"EnvNeedIntegral",width:280},{title:"变量提示内容",dataIndex:"EnvTips",width:280},{title:"操作时间",dataIndex:"UpdatedAt",width:280},{title:"操作",dataIndex:"operation",customKey:"operation",fixed:"right",width:300}],E=t([]),S=()=>{y()},A=e=>{u.value=!0,n.value=e?{...e,title:"变量编辑"}:{title:"变量新增"}},N=e=>{e&&(g.value=1);let a={page:g.value,quantity:f.value};j({data:h,splicingData:a}).then((e=>{b.value?v.value=0:v.value=e.page*f.value,E.value=(e.pageData||e||[]).map((e=>(e.CreatedAt&&(e.CreatedAt=k(e.CreatedAt)),e.UpdatedAt&&(e.UpdatedAt=k(e.UpdatedAt)),e)))}))};return(e,a)=>{const t=p("a-button"),s=p("a-form-item"),b=p("a-popconfirm"),j=p("a-form");return l(),m(_,null,[d(z,{visible:u.value,"onUpdate:visible":a[0]||(a[0]=e=>u.value=e),onUpdateData:a[1]||(a[1]=e=>N(!0)),dataObj:n.value},null,8,["visible","dataObj"]),d(D,{columns:I,pageSize:f.value,"onUpdate:pageSize":a[3]||(a[3]=e=>f.value=e),current:g.value,"onUpdate:current":a[4]||(a[4]=e=>g.value=e),total:v.value,"onUpdate:total":a[5]||(a[5]=e=>v.value=e),isTable:!0,isSearch:!0,onOnShowSizeChange:N,onInitData:N,dataSource:E.value},{search:r((()=>[d(j,{class:"flex flex-warp",model:h},{default:r((()=>[d(s,null,{default:r((()=>[d(t,{type:"primary",onClick:a[2]||(a[2]=c((e=>A()),["prevent"])),class:"filter-search"},{default:r((()=>[V])),_:1})])),_:1}),d(b,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:S},{title:r((()=>[L])),default:r((()=>[d(t,{type:"danger",style:{"margin-left":"10px"},shape:"round"},{default:r((()=>[M])),_:1})])),_:1})])),_:1},8,["model"])])),bodyCell:r((({text:e,record:a,index:n,column:u})=>["money"===u.customKey?(l(),i(q,{key:0,num:e},null,8,["num"])):o("",!0),"operation"===u.customKey?(l(),m(_,{key:1},[d(t,{type:"primary",onClick:c((e=>A(a)),["stop"]),style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:r((()=>[T])),_:2},1032,["onClick"]),d(b,{placement:"topLeft","ok-text":"是","cancel-text":"否",onConfirm:e=>{x({data:{id:[a.ID]}}).then((()=>{w.success("操作成功!"),N(!0)}))}},{title:r((()=>[K])),default:r((()=>[d(t,{type:"danger",style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:r((()=>[Q])),_:1})])),_:2},1032,["onConfirm"])],64)):o("",!0)])),_:1},8,["pageSize","current","total","dataSource"])],64)}}};export{B as default};
