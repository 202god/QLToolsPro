import{_ as S}from"./_plugin-vue_export-helper.5059d46b.js";import{y as V,z,e as r,B as K,l as v,o as y,c as D,f as b,x as O,C as w,b as a,F as I,r as R,w as p,D as Y,g as A,m as E,E as G,G as M,H as Q}from"./index.c6516d62.js";const j=V({props:{isWatch:{type:Boolean,default:!0},title:{type:String,default:""},isLoad:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},data:{type:Array,default:[1]}},setup(n,C){const{title:f,isLoad:m,loading:N,data:_,isWatch:h}=z(n),o=r(null),l=r(0),d=r(0);return h.value&&(K(()=>{l.value=o.value.offsetHeight,d.value=o.value.offsetWidth}),window.addEventListener("resize",()=>{!o.value||!o.value.offsetHeight||(l.value=0,setTimeout(()=>{l.value=o.value.offsetHeight,d.value=o.value.offsetWidth},1e3))})),{contentWidth:d,contentHeight:l,myRef:o,title:f,isLoad:m,loading:N}}}),J={class:"flex flex-column pc-container"},X={class:"container-title"},Z={class:"container-title-content"},ee={class:"title-text flex content-between"},ae={class:"tilte-left"},te={class:"container-table flex-base flex flex-column",ref:"myRef"},ne={key:0,class:"load-spin flex align-items flex-base"},le={key:1,class:"flex-base flex align-items p-no-data"};function oe(n,C,f,m,N,_){const h=v("a-spin"),o=v("a-empty");return y(),D("div",J,[b("div",X,[b("div",Z,[b("div",ee,[b("div",ae,O(n.title),1),w(n.$slots,"title")])])]),b("div",te,[!n.contentHeight||n.isLoad&&n.loading?(y(),D("div",ne,[a(h)])):(y(),D(I,{key:1},[n.contentHeight&&n.data.length?w(n.$slots,"content",{key:0,width:n.contentWidth,height:n.contentHeight}):(y(),D("div",le,[a(o)]))],64))],512)])}const ue=S(j,[["render",oe]]),se=A("\u63D0\u4EA4"),ve={__name:"upload-data",emits:["tipChange"],setup(n,{emit:C}){const f=r(!1),m=r(""),N=r(""),_=r(""),h={labelCol:{span:3},wrapperCol:{span:21}},o={serverID:[{required:!0,trigger:"change",message:"\u8BF7\u8F93\u5165\u670D\u52A1\u5668ID!"}],envName:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D8\u91CF\u540D!",trigger:"change"}]},l=r(0),d=r([]),u=r([]),t=R({serverID:"",envName:"",envData:""}),F=()=>{if(!_.value){E.error("\u8BF7\u8F93\u5165CD-KEY\u5BC6\u94A5\uFF01");return}G({data:{cdk:_.value}}).then(s=>{E.success("\u66F4\u65B0CD-KEY\u5BC6\u94A5\u6210\u529F!"),f.value=!1})},T=s=>{M({data:{server_id:t.serverID,env_name:t.envName,env_data:t.envData}}).then(e=>{E.success("\u53D8\u91CF\u63D0\u4EA4\u6210\u529F")}).catch(e=>{}),console.log("Success:",s)},q=s=>{console.log("Failed:",s)},H=()=>{Q({}).then(s=>{d.value=s.online.map(e=>({label:e.PanelName,value:e.id,envData:e.env_data})),t.serverID=d.value[0].value;try{u.value=d.value[0].envData.map(e=>({label:e.EnvName,value:e.EnvName,quantity:e.EnvQuantity,EnvTips:e.EnvTips})),t.envName=u.value[0].value,l.value=u.value[0].quantity,m.value=u.value[0].EnvTips,C("tipChange",m.value)}catch{}})},x=(s,e)=>e.label.indexOf(s)>=0,$=(s,e)=>{t.envName="",l.value="";try{u.value=e.envData.map(c=>({label:c.EnvName,value:c.EnvName,quantity:c.EnvQuantity,EnvTips:c.EnvTips})),t.envName=u.value[0].value,l.value=u.value[0].quantity,m.value=u.value[0].EnvTips,C("tipChange",m.value)}catch{}},B=(s,e)=>{l.value="",l.value=e.quantity};return H(),(s,e)=>{const c=v("a-select"),g=v("a-form-item"),k=v("a-input"),U=v("a-textarea"),W=v("a-button"),L=v("a-form"),P=v("a-modal");return y(),D(I,null,[a(L,Y({model:t,name:"basic"},h,{onFinish:T,rules:o,onFinishFailed:q}),{default:p(()=>[a(g,{label:"\u670D\u52A1\u5668:",name:"serverID"},{default:p(()=>[a(c,{value:t.serverID,"onUpdate:value":e[0]||(e[0]=i=>t.serverID=i),placeholder:"\u8BF7\u9009\u62E9","filter-option":x,"show-search":"",onChange:$,"option-label-prop":"label",options:d.value},null,8,["value","options"])]),_:1}),a(g,{label:"\u53D8\u91CF\u7EC4:",name:"envName"},{default:p(()=>[a(c,{value:t.envName,"onUpdate:value":e[1]||(e[1]=i=>t.envName=i),placeholder:"\u8BF7\u9009\u62E9","filter-option":x,"show-search":"",onChange:B,"option-label-prop":"label",options:u.value},null,8,["value","options"])]),_:1}),a(g,{label:"\u5269\u4F59\u4F4D\u7F6E",name:"serverID","has-feedback":""},{default:p(()=>[a(k,{value:l.value,"onUpdate:value":e[2]||(e[2]=i=>l.value=i),disabled:!0},null,8,["value"])]),_:1}),a(g,{name:"envData",label:"\u53D8\u91CF\u503C","has-feedback":"",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D8\u91CF\u503C!"}]},{default:p(()=>[a(U,{value:t.envData,"onUpdate:value":e[3]||(e[3]=i=>t.envData=i),placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u503C!"},null,8,["value"])]),_:1}),a(g,{"wrapper-col":{offset:2,span:10}},{default:p(()=>[a(W,{type:"primary","html-type":"submit"},{default:p(()=>[se]),_:1})]),_:1})]),_:1},16,["model"]),a(P,{visible:f.value,"onUpdate:visible":e[5]||(e[5]=i=>f.value=i),title:N.value,centered:"",onOk:F},{default:p(()=>[a(k,{value:_.value,"onUpdate:value":e[4]||(e[4]=i=>_.value=i),placeholder:"\u8BF7\u8F93\u5165CD-KEY\u5BC6\u94A5",size:"large"},null,8,["value"])]),_:1},8,["visible","title"])],64)}}};export{ve as _,ue as b};
