import{z as q,e as d,r as z,N as B,o as w,n as L,w as a,b as t,q as O,D as T,g as f,as as K,m as $,l as i,X as G,S as X,c as Z,F as H,at as J,Z as I,a3 as Q,p as W,au as Y,av as ee}from"./index.c6516d62.js";import{p as te}from"./p-center-modal.bb6cca38.js";import{U as ae}from"./UploadOutlined.64046583.js";import{_ as oe}from"./page-container.9c5635db.js";import{d as V}from"./common.15b1556d.js";import"./_plugin-vue_export-helper.5059d46b.js";import"./store.f76b099d.js";const ne=f(" \u4E0A\u4F20 "),le=f("\u53D6\u6D88"),se=f("\u63D0\u4EA4"),ie={__name:"editOrAdd",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(k,{emit:h}){const b=k,{visible:_,dataObj:A}=q(b),v=d([{value:"ordinary",label:"\u666E\u901A"},{value:"cron",label:"\u5B9A\u65F6"}]),c=()=>{h("update:visible",!1)},n=z({type:"ordinary",file:[]}),m={type:[{required:!0,trigger:"change"}],file:[{required:!0,trigger:"change",message:"\u8BF7\u4E0A\u4F20\u63D2\u4EF6"}]},M=u=>!1,S=u=>{console.log(u)},E=(...u)=>{console.log(u)},U={labelCol:{span:7},wrapperCol:{span:15}},F=u=>{const r={file:n.file};let y={type:n.type};K({splicingData:y,data:r}).then(()=>{$.success("\u64CD\u4F5C\u6210\u529F"),h("updateData",r),c()})};B(_,(u,r,y)=>{_.value&&C()});const C=()=>{n.type="ordinary",n.file=[]};return(u,r)=>{const y=i("a-select"),p=i("a-form-item"),x=i("a-button"),s=i("a-upload"),e=i("a-divider"),g=i("a-form");return w(),L(te,{modalVisible:O(_),isFooter:!1,onClose:c,title:"\u4E0A\u4F20\u63D2\u4EF6"},{content:a(()=>[t(g,T({ref:"formRef",name:"custom-validation",model:n,rules:m},U,{onValidate:E,onFinishFailed:S,onFinish:F}),{default:a(()=>[t(p,{label:"\u7C7B\u578B:",name:"type"},{default:a(()=>[t(y,{value:n.type,"onUpdate:value":r[0]||(r[0]=o=>n.type=o),placeholder:"\u8BF7\u9009\u62E9",style:{width:"200px"},options:v.value},null,8,["value","options"])]),_:1}),t(p,{label:"\u63D2\u4EF6",name:"file"},{default:a(()=>[t(s,{fileList:n.file,"onUpdate:fileList":r[1]||(r[1]=o=>n.file=o),"max-count":1,"before-upload":M},{default:a(()=>[t(x,null,{default:a(()=>[t(O(ae)),ne]),_:1})]),_:1},8,["fileList"])]),_:1}),t(e),t(p,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:a(()=>[t(x,{onClick:c},{default:a(()=>[le]),_:1}),t(x,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:a(()=>[se]),_:1})]),_:1})]),_:1},16,["model"])]),_:1},8,["modalVisible"])}}},re=f(" \u9875\u9762\u5237\u65B0 "),pe=f(" \u5237\u65B0\u5B9A\u65F6\u63D2\u4EF6 "),de=f(" \u4E0A\u4F20\u63D2\u4EF6 "),ue=f(" \u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F "),ce=f("\u5220\u9664 "),Ce={__name:"index",setup(k){const h=d({}),b=d(!1),_=d({}),A=G.useForm,v=d(0),c=d(1),n=d(10);X.PRESENTED_IMAGE_SIMPLE;const m=z({type:"ordinary"});d(!1);const{resetFields:M,validate:S,validateInfos:E}=A(m),U=d([{value:"ordinary",label:"\u666E\u901A"},{value:"cron",label:"\u5B9A\u65F6"}]),F=[{title:"\u6587\u4EF6\u540D\u79F0",dataIndex:"file_name"},{title:"\u63D2\u4EF6\u540D\u79F0",dataIndex:"plugin_name"},{title:"\u5B9A\u65F6\u65F6\u95F4",dataIndex:"cron_time"},{title:"\u5BB9\u5668\u540D\u79F0",dataIndex:"need_env_name"},{title:"\u64CD\u4F5C",dataIndex:"operation",customKey:"operation"}],C=d([]),u=s=>{b.value=!0},r=s=>{ee().then(()=>{$.success("\u5237\u65B0\u6210\u529F!"),p(!0)})},y=s=>{Y({data:{type:_.value.type,file_name:s.file_name}}).then(()=>{$.success("\u64CD\u4F5C\u6210\u529F!"),p(!0)})},p=s=>{s&&(c.value=1);let e={page:c.value,quantity:n.value,type:_.value.type};J({data:m,splicingData:e}).then(g=>{try{v.value=(g.page||0)*n.value}catch{v.value=0}C.value=(g||[]).map(o=>(o.CreatedAt&&(o.CreatedAt=V(o.CreatedAt)),o.UpdatedAt&&(o.UpdatedAt=V(o.UpdatedAt)),o))})},x=()=>{S().then(s=>{_.value=m,p(!0)}).catch(s=>{console.log("error",s)})};return(s,e)=>{const g=i("a-select"),o=i("a-form-item"),D=i("a-button"),N=i("a-form"),j=i("a-popconfirm");return w(),Z(H,null,[t(ie,{visible:b.value,"onUpdate:visible":e[0]||(e[0]=l=>b.value=l),onUpdateData:e[1]||(e[1]=l=>p(!0)),dataObj:h.value},null,8,["visible","dataObj"]),t(oe,{columns:F,pageSize:n.value,"onUpdate:pageSize":e[6]||(e[6]=l=>n.value=l),current:c.value,"onUpdate:current":e[7]||(e[7]=l=>c.value=l),total:v.value,"onUpdate:total":e[8]||(e[8]=l=>v.value=l),isTable:!0,isSearch:!0,onOnShowSizeChange:p,onInitData:p,dataSource:C.value},{search:a(()=>[t(N,{class:"flex flex-warp",model:m},{default:a(()=>[t(o,{label:"\u7C7B\u578B:",name:"type"},{default:a(()=>[t(g,{value:m.type,"onUpdate:value":e[2]||(e[2]=l=>m.type=l),placeholder:"\u8BF7\u9009\u62E9",style:{width:"200px"},options:U.value},null,8,["value","options"])]),_:1}),t(o,null,{default:a(()=>[t(D,{type:"primary",onClick:e[3]||(e[3]=I(l=>x(),["prevent"])),class:"filter-search"},{default:a(()=>[t(O(Q)),re]),_:1}),t(D,{type:"primary",style:{"margin-left":"10px"},shape:"round",onClick:e[4]||(e[4]=I(l=>r(),["prevent"]))},{default:a(()=>[pe]),_:1}),t(D,{type:"primary",style:{"margin-left":"10px"},shape:"round",onClick:e[5]||(e[5]=I(l=>u(),["prevent"]))},{default:a(()=>[de]),_:1})]),_:1})]),_:1},8,["model"])]),bodyCell:a(({text:l,record:P,index:me,column:R})=>[R.customKey==="operation"?(w(),L(j,{key:0,placement:"topLeft","ok-text":"\u662F","cancel-text":"\u5426",onConfirm:fe=>y(P)},{title:a(()=>[ue]),default:a(()=>[t(D,{type:"danger",style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:a(()=>[ce]),_:1})]),_:2},1032,["onConfirm"])):W("",!0)]),_:1},8,["pageSize","current","total","dataSource"])],64)}}};export{Ce as default};
