import{z as Z,r as T,N as H,o as V,n as J,w as a,b as e,D as Q,q as I,g as m,a9 as W,m as q,l as u,e as p,X as Y,S as ee,c as $,F as N,aa as ae,Z as j,a3 as te,p as ne,ab as le}from"./index.c6516d62.js";import{p as oe}from"./p-center-modal.bb6cca38.js";import{_ as se}from"./page-container.9c5635db.js";import{d as P}from"./common.15b1556d.js";import{S as re}from"./SyncOutlined.74d523b0.js";import"./_plugin-vue_export-helper.5059d46b.js";import"./store.f76b099d.js";const ue=m("\u53D6\u6D88"),ie=m("\u63D0\u4EA4"),de={__name:"editOrAdd",props:{dataObj:Object,visible:Boolean},emits:["update:visible","updateData"],setup(z,{emit:y}){const h=z,{visible:f,dataObj:c}=Z(h),d=()=>{y("update:visible",!1)},l=T({remarks:"",value:""}),g={value:[{required:!0,trigger:"change"}],remarks:[{required:!0,trigger:"change"}]},i=_=>{console.log(_)},A=(..._)=>{console.log(_)},w={labelCol:{span:7},wrapperCol:{span:15}},O=_=>{const s={...l,panel_name:c.value.panel_name,id:c.value.id,_id:c.value._id,name:c.value.name};W({data:s}).then(()=>{q.success("\u64CD\u4F5C\u6210\u529F"),y("updateData",s),d()})};H(f,(_,s,x)=>{f.value&&E()});const E=()=>{l.remarks=c.value.remarks||"",l.value=c.value.value||""};return(_,s)=>{const x=u("a-input"),C=u("a-form-item"),S=u("a-divider"),k=u("a-button"),b=u("a-form");return V(),J(oe,{modalVisible:I(f),isFooter:!1,onClose:d,title:"\u53D8\u91CF\u4FEE\u6539"},{content:a(()=>[e(b,Q({ref:"formRef",name:"custom-validation",model:l,rules:g},w,{onValidate:A,onFinishFailed:i,onFinish:O}),{default:a(()=>[e(C,{label:"\u53D8\u91CF\u503C",name:"value"},{default:a(()=>[e(x,{value:l.value,"onUpdate:value":s[0]||(s[0]=D=>l.value=D)},null,8,["value"])]),_:1}),e(C,{label:"\u53D8\u91CF\u5907\u6CE8",name:"remarks"},{default:a(()=>[e(x,{value:l.remarks,"onUpdate:value":s[1]||(s[1]=D=>l.remarks=D)},null,8,["value"])]),_:1}),e(S),e(C,{"wrapper-col":{span:12,offset:12},class:"timed-start-button"},{default:a(()=>[e(k,{onClick:d},{default:a(()=>[ue]),_:1}),e(k,{type:"primary",style:{"margin-left":"20px"},"html-type":"submit"},{default:a(()=>[ie]),_:1})]),_:1})]),_:1},16,["model"])]),_:1},8,["modalVisible"])}}},pe=m("\u9762\u677F"),me=m("\u7528\u6237"),ce=m(" \u641C\u7D22 "),_e=m("\u91CD\u7F6E "),ve=m("\u4FEE\u6539 "),fe=m(" \u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F "),ge=m("\u5220\u9664 "),Fe={__name:"index",setup(z){const y=p({}),h=p({}),f=p(!1),c=Y.useForm,d=p(0),l=p(1),g=p(10);ee.PRESENTED_IMAGE_SIMPLE;const i=T({s:"",type:"panel"}),A=p(!1),{resetFields:w,validate:O,validateInfos:E}=c(i),_=[{title:"\u9762\u677F\u540D\u79F0",dataIndex:"panel_name",width:200},{title:"\u53D8\u91CF\u540D\u79F0",dataIndex:"name",key:"name"},{title:"\u53D8\u91CF\u503C",dataIndex:"value",key:"value"},{title:"\u64CD\u4F5C",dataIndex:"operation",customKey:"operation"}],s=p([]),x=n=>{f.value=!0,n?y.value={...n,title:"\u9762\u677F\u7F16\u8F91"}:y.value={title:"\u9762\u677F\u65B0\u589E"}},C=n=>{le({data:{panel_name:n.panel_name,id:n.id,_id:n._id}}).then(()=>{q.success("\u64CD\u4F5C\u6210\u529F!"),b(!0)})},S=p([]),k=()=>{let n=l.value*g.value;n>d.value&&(n=d.value),s.value=S.value.slice((l.value-1)*g.value,n),console.log("dataAll.value ",s.value)},b=n=>{n&&(l.value=1);let t=h.value;t.page=l.value,t.quantity=g.value,ae({data:i,splicingData:t}).then(F=>{S.value=F.filter(v=>v.panel_env&&v.panel_name).map(v=>v.panel_env?v.panel_env.map(r=>(r.panel_name=v.panel_name,r.CreatedAt&&(r.CreatedAt=P(r.CreatedAt)),r.UpdatedAt&&(r.UpdatedAt=P(r.UpdatedAt)),r)):[]).flat(),d.value=S.value.length,k()})};h.value=i;const D=()=>{w(),A.value=!1,b(!0)},B=()=>{O().then(n=>{h.value=i,b(!0)}).catch(n=>{console.log("error",n)})};return(n,t)=>{const F=u("a-radio"),v=u("a-radio-group"),r=u("a-form-item"),R=u("a-input"),U=u("a-button"),K=u("a-form"),L=u("a-popconfirm");return V(),$(N,null,[e(de,{visible:f.value,"onUpdate:visible":t[0]||(t[0]=o=>f.value=o),onUpdateData:t[1]||(t[1]=o=>b(!0)),dataObj:y.value},null,8,["visible","dataObj"]),e(se,{columns:_,pageSize:g.value,"onUpdate:pageSize":t[4]||(t[4]=o=>g.value=o),current:l.value,"onUpdate:current":t[5]||(t[5]=o=>l.value=o),total:d.value,"onUpdate:total":t[6]||(t[6]=o=>d.value=o),isTable:!0,isSearch:!0,onOnShowSizeChange:k,onInitData:b,dataSource:s.value},{search:a(()=>[e(K,{class:"flex flex-warp",model:i},{default:a(()=>[e(r,{label:"\u641C\u7D22\u7C7B\u578B:",name:"type"},{default:a(()=>[e(v,{value:i.type,"onUpdate:value":t[2]||(t[2]=o=>i.type=o)},{default:a(()=>[e(F,{value:"panel",name:"type"},{default:a(()=>[pe]),_:1}),e(F,{value:"user",name:"type"},{default:a(()=>[me]),_:1})]),_:1},8,["value"])]),_:1}),e(r,{label:"\u5173\u952E\u5B57:",name:"s"},{default:a(()=>[e(R,{value:i.s,"onUpdate:value":t[3]||(t[3]=o=>i.s=o),placeholder:"\u8BF7\u8F93\u5165\u5173\u952E\u5B57"},null,8,["value"])]),_:1}),e(r,null,{default:a(()=>[e(U,{type:"primary",onClick:j(B,["prevent"]),class:"filter-search"},{default:a(()=>[e(I(te)),ce]),_:1},8,["onClick"]),e(U,{style:{"margin-left":"10px"},class:"filter-reset",onClick:D},{default:a(()=>[e(I(re)),_e]),_:1})]),_:1})]),_:1},8,["model"])]),bodyCell:a(({text:o,record:M,index:be,column:G})=>[G.customKey==="operation"?(V(),$(N,{key:0},[e(U,{type:"primary",onClick:j(X=>x(M),["stop"]),style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:a(()=>[ve]),_:2},1032,["onClick"]),e(L,{placement:"topLeft","ok-text":"\u662F","cancel-text":"\u5426",onConfirm:X=>C(M)},{title:a(()=>[fe]),default:a(()=>[e(U,{type:"danger",style:{"margin-left":"10px","margin-bottom":"10px"},shape:"round"},{default:a(()=>[ge]),_:1})]),_:2},1032,["onConfirm"])],64)):ne("",!0)]),_:1},8,["pageSize","current","total","dataSource"])],64)}}};export{Fe as default};
